{# accounts/templates/accounts/partials/profile/_profile.html #}

<div class="container mt-5" style="max-width: 820px;">
  <div class="card shadow-sm border-0">
    <div class="card-body p-4">

      <div class="d-flex justify-content-between align-items-start gap-3 mb-4">
        <h4 class="m-0">Informações do Perfil</h4>

        {% comment %}
          
        
        {# Botão seguir / deixar de seguir (somente quando não for o próprio usuário) #}
        {% if not is_me %}
          <form method="post" action="{% url 'accounts:follow_toggle' profile_user.id %}">
            {% csrf_token %}
            {# Esse btn deveria estar oculto? Não está #}
            <input type="hidden" name="next" value="{{ request.get_full_path }}" />
            {% if is_following %}
              <button class="btn btn-sm btn-outline-secondary" type="submit">
                <i class="bi bi-person-dash"></i>
                <span class="d-none d-md-inline">Deixar de seguir</span>
              </button>
            {% else %}
              <button class="btn btn-sm btn-primary" type="submit">
                <i class="bi bi-person-plus"></i>
                <span class="d-none d-md-inline">Seguir</span>
              </button>
            {% endif %}
          </form>
        {% endif %}
        {% endcomment %}
      </div>

      <dl class="row">

        {# NOME DE EXIBIÇÃO #}
        {% if profile_user.display_name %}
          <dt class="col-sm-3">Nome Exibido</dt>
          <dd class="col-sm-9">
            <strong>{{ profile_user.display_name }}</strong>
          </dd>
        {% endif %}

        {# NOME DE USUÁRIO (USERNAME) #}
        <dt class="col-sm-3">Usuário</dt>
        <dd class="col-sm-9 text-muted">@{{ profile_user.username }}</dd>

        {# PAPEL (ROLE) #}
        {% if profile_user.role %}
          <dt class="col-sm-3">Papel/Função</dt>
          <dd class="col-sm-9">
            {# O método get_FOO_display() é nativo do Django para campos choices #}
            {{ profile_user.get_role_display }}
          </dd>
        {% endif %}

        {# DATA DE CADASTRO #}
        <dt class="col-sm-3">Membro desde</dt>
        <dd class="col-sm-9">
          {{ profile_user.date_joined|date:"d/m/Y" }}
        </dd>

        {# Aqui, acescentar número de seguidores #}
        <dt class="col-sm-3">Seguidores</dt>
        <dd class="col-sm-9">
          <span class="fw-semibold">{{ followers_count|default:0 }}</span>
        </dd>

        {# (Opcional) Seguindo #}
        <dt class="col-sm-3">Seguindo</dt>
        <dd class="col-sm-9">
          <span class="fw-semibold">{{ following_count|default:0 }}</span>
        </dd>

        {# GRUPOS #}
        <dt class="col-sm-3">Grupos</dt>
        <dd class="col-sm-9">
          {% if profile_user.group_memberships.all %}
            <ul class="list-unstyled mb-0">
              {% for membership in profile_user.group_memberships.all %}
                {% if membership.group.is_active %}
                  <li>{{ membership.group.name }}</li>
                {% endif %}
              {% endfor %}
            </ul>
          {% else %}
            <span class="text-muted">Não participa de nenhum grupo</span>
          {% endif %}
        </dd>

      </dl>

    </div>
  </div>
</div>
