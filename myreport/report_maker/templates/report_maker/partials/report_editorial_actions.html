{# myreport/report_maker/templates/report_maker/partials/report_editorial_actions.html #}
{% comment %}
  Ações editoriais do laudo
  Uso:
    {% include "report_maker/partials/report_editorial_actions.html" with report=report %}
    {% include "report_maker/partials/report_editorial_actions.html" with report=report compact=True %}
{% endcomment %}

{% if report.can_edit %}

  {% if compact %}
    <div class="btn-group btn-group-sm">
      <a href="{% url 'report_maker:text_block_upsert' report.pk 'SUMMARY' %}"
         class="btn btn-outline-secondary"
         title="Resumo">
        <i class="bi bi-card-text"></i>
      </a>

      <a href="{% url 'report_maker:text_block_upsert' report.pk 'CONCLUSION' %}"
         class="btn btn-outline-secondary"
         title="Conclusão">
        <i class="bi bi-chat-text"></i>
      </a>

      <a href="{% url 'report_maker:exam_object_dashboard' report.pk %}"
         class="btn btn-outline-primary"
         title="Objetos de exame">
        <i class="bi bi-plus-lg"></i>
      </a>
    </div>

  {% else %}
    <div class="btn-group">
      <a href="{% url 'report_maker:exam_object_dashboard' report.pk %}"
         class="btn btn-sm btn-outline-primary">
        <i class="bi bi-plus-lg"></i>
        Novo objeto
      </a>

      <button type="button"
              class="btn btn-sm btn-outline-secondary dropdown-toggle dropdown-toggle-split"
              data-bs-toggle="dropdown"
              aria-expanded="false">
        <span class="visually-hidden">Novo texto</span>
      </button>

      <ul class="dropdown-menu dropdown-menu-end">
        <li>
          <a class="dropdown-item"
             href="{% url 'report_maker:text_block_upsert' report.pk 'PREAMBLE' %}">
            Preâmbulo
          </a>
        </li>

        <li>
          <a class="dropdown-item"
             href="{% url 'report_maker:text_block_upsert' report.pk 'SUMMARY' %}">
            Resumo
          </a>
        </li>

        <li>
          <a class="dropdown-item"
             href="{% url 'report_maker:text_block_upsert' report.pk 'TOC' %}">
            Sumário
          </a>
        </li>

        {% if editorial_groups %}
          <li><hr class="dropdown-divider"></li>

          {# Texto comum por grupo (somente se houver >= 2 objetos no grupo) #}
          {% for g in editorial_groups %}
            <li>
              <a class="dropdown-item"
                 href="{% url 'report_maker:text_block_upsert' report.pk 'OBJECT_GROUP_INTRO' %}?group_key={{ g.key }}">
                {{ g.label }} – texto comum do grupo
              </a>
            </li>
          {% endfor %}
        {% endif %}

        <li><hr class="dropdown-divider"></li>

        <li>
          <a class="dropdown-item"
             href="{% url 'report_maker:text_block_upsert' report.pk 'FINAL_CONSIDERATIONS' %}">
            Considerações finais
          </a>
        </li>

        <li>
          <a class="dropdown-item"
             href="{% url 'report_maker:text_block_upsert' report.pk 'CONCLUSION' %}">
            Conclusão
          </a>
        </li>
      </ul>
    </div>
  {% endif %}

{% endif %}
